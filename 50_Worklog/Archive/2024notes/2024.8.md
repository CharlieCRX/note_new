# 8月份日报

## 8.5

重新回顾了cachelab的实验文档，发现在内存中读取数据的时候，默认所有的数据都是块对齐的，所以直接忽视块大小就可以。

woc？这波算是我的失误了

- [x] 简化`int find_cache_line`的输入为：缓存和数据索引信息，输出为对应行的索引。

- [x] 设计`handle_memory_operation(Cache *cache, MemoryOperation operation, int verbose)`

  描述：输入缓存系统，内存操作和输出标志。根据指令和地址，实现查找缓存块、更新缓存块的操作

  - [x] 若指令是修改，则需要操作两次缓存，其他仅需一次操作`handle_cache_operation(Cache *cache, int int set_index)`

- [x] 设计缓存操作：`void handle_cache_operation(Cache *cache, int index, int tag, int verbose)`

  - [x] 查询数据是否存在于缓存中`int find_cache_line(Cache *cache, int index, int tag)`
  - [x] 如果不存在，则miss，并执行插入缓存的操作`update_cache_line(Cache *cache, int index, int tag, int verbose)`
  - [x] 如果存在，则不执行操作

- [x] 设计`void update_cache_line(Cache *cache, int set_index)`

  - [x] 获取集合中特定的空行索引`line_index`。`int get_empty_line_index(Cache *cache, int set_index)`

  - [x] 如不存在空行，则根据LRU原则获取最近最少使用的行索引`line_index`。`int get_eviction_line_index(Cache *cache, int set_index)`

  - [x] 更新特定行的tag和valid：`cache->sets[set_index].lines[line_index].valid = 1;tag = spcific tag`


## 8.7

当你迷茫的时候，请你回头看看吧！

按时完成，解决拖延。

感觉有点焦虑了。

不过已经做得很好了。

cachelab的partA部分，将代码写完，并且将测试案例写完测完，所有函数基本都有注释。

再这样代码量体系下，依然做到了21分（满分27分），值得鼓励啊！

:grinning:

这个进度的话，九月份之前，应该能将PA和csapp剩余三章节整完。

主要是，恐惧于自己前段时间的cachelab，投入时间巨多，但是汇报较少。

花费的时间主要构成：

1. 对于实验材料的要求，没有做到熟悉理解。所以对于缓存的写操作，自己实现的功能很繁琐。

2. 有点依赖于chatgpt的代码生成功能，导致其实有部分代码理解不是很通顺，糊弄着就过去了

   这样就会导致遇到bug就不会调试

   - 独立解决问题
     - 即使是调一个很弱智的bug, "顺带"能学到的东西也比你想象中多得多
     - 换句话说, 如果你选择抱大腿, 你失去的机会也比你想象中多得多
   - 尝试尽可能理解每一处细节
     - 将来调bug的时候, 这些细节就是你手中强有力的工具
     - 换句话说, 当你在调bug的时候感到无从下手, 一定是你不了解其中的细节

3. 项目性的c代码能力太弱，感觉有很多可以优化变强的地方自己并不了解。

本周任务：

- 完成pa1

我现在看到pa的C语言项目已经迫不及待了！！！！

## 8.8

今天下午做可乐鸡翅，然后pa进度推进，需要掌握两个知识：

- 如何找到函数的原型实现？grep
- c语言的预处理章节，需要理解相应的预处理

现在还有一个问题，就是csapp的第七章还没有翻译单词呢，这个做完饭之后可以处理一下。

今天突然看到了自己csdn上当年整理的pa学习记录，当时的我也是不会环境变量和path变量，在博客中做了记录。然而今天看来，当时写的确实是没用上——因为工作中真的不用这个。哈哈哈

## 8.9

看pa项目看的我头疼，明天gdb调试一下。

## 8.13

宝贝这两天生病了:confounded:

咳嗽，头痛的严重，上午检查是鼻窦炎。

希望让我可爱的女朋友身体快点好起来吧！

今天扎实地往前走吧。

## 8.14

- [x] 整理完毕PA的`init_monitor()`函数
- [x] PA1发布到博客

## 8.30

记录下自己刚才在一个新环境中重新下载PA项目代码并且运行时候遇到的问题。

## 拉取代码

首先拉取远程代码的主分支：

```bash
git clone git@github.com:CharlieCRX/pa.git
```

`git clone`默认只会拉取并检出远程仓库的默认分支（通常是`main`或者`master`分支），但同时，所有远程分支的信息都会被拉取，但是不会被检出到本地工作目录。

然后切换到现在进行的分支`pa1`

```bash
crx@ubuntu:pa$ git checkout pa1
Branch 'pa1' set up to track remote branch 'pa1' from 'origin'.
Switched to a new branch 'pa1'
```

此时检出命令`git checkout`输出的含义为：

1. 本地创建`pa1`分支来追踪远程仓库`origin`中的`pa1`分支
2. 切换分支到`pa1`

因为之前设置过PA的环境变量，所以需要在`~/.bashrc`中设置好两个变量`NEMU_HOME`和`AM_HOME`

```BASH
export NEMU_HOME= path/pa/nemu
export AM_HOME= path/pa/abstract-machine
```

## 运行

然后进入到`/nemu`路径下，执行`make menuconfig`来运行配置文件。（:warning:不运行会报错 ）

然后就可以正常编译程序了

```bash
crx@ubuntu:nemu$ make -j8
+ CC src/nemu-main.c
+ CC src/engine/interpreter/init.c
+ CC src/engine/interpreter/hostcall.c
...
```

最后输入`make run`运行`nemu`即可。
