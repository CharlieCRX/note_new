好，这一段我**不是帮你“解释概念”**，而是帮你**把话说到 PLC 工程师也无法反驳、也不敢乱改的程度**。
目标只有一个：**让“绝对 / 相对位置体系”的价值变成工程约束，而不是“个人习惯”**。

------

# 绝对位置系统 与 相对位置系统 的设计说明

> 本系统明确区分 **绝对位置系统** 与 **相对位置系统**，
> 两者职责不同、生命周期不同、修改权限不同。

------

## 一、绝对位置系统（Absolute Position System）

### 1. 定义

**绝对位置**是轴在真实机械结构中的**物理位置表达**，其基准来源于：

- 绝对值编码器
- 机械零点（Mechanical Zero）
- 与物理限位、行程安全强相关

单位：

- 直线轴：mm
- 旋转轴：°

------

### 2. 核心特性（必须强调）

- 与 **机械零点、机械限位** 强绑定
- 用于：
  - 安全判断
  - 行程保护
  - 同步轴物理对齐
- **一旦建立，不允许随意修改**

> ⚠️ 修改绝对位置 = 修改机械坐标体系
> 这是 **受控操作**，不是日常功能

------

### 3. 设计约束（红线）

- 绝对位置：
  - 上电即有效
  - 不依赖回零流程
- 绝对位置清零：
  - 仅允许在停机状态
  - 仅用于机械标定或回原点流程
  - 不用于日常测试或调试

**PLC 程序必须将绝对位置视为“物理事实”，而非“用户意图”**

------

## 二、相对位置系统（Relative Position System）

### 1. 引入目的

相对位置系统 **不是为了控制硬件**，而是为了：

- **测试**
- **调试**
- **工艺验证**
- **用户操作便利性**

它解决的是一个现实问题：

> **用户关心“从我关心的点开始动了多少”，
> 而不是“现在在机械第几度”。**

------

### 2. 定义

相对位置是 PLC 软件层维护的**逻辑位置**，由以下两部分组成：

- 当前绝对位置
- 用户定义的相对原点偏移

计算关系：

```c
Relative Position = Absolute Position - Relative Zero Offset
```

------

### 3. 相对原点的语义（必须说清）

#### 设置相对原点

- 行为：
  - 用户将“当前所在位置”定义为新的参考 0 点
- PLC 行为：

```c
RelativeZeroOffset := AbsolutePosition
```

- 结果：
  - 相对位置显示为 0
  - 绝对位置不变

------

#### 清除相对原点

- 行为：
  - 用户放弃自定义参考点
- PLC 行为（推荐）：

```c
RelativeZeroOffset := AbsolutePosition
```

- 结果：
  - 相对位置与绝对位置数值一致

------

### 4. 使用示例

#### 示例场景（旋转轴）

- 当前绝对位置：`27°`
- 用户执行：**设置当前位置为相对原点**

此时：

- 绝对位置 = `27°`
- 相对位置 = `0°`

------

随后旋转轴继续运动到：

- 绝对位置 = `60°`

PLC 显示：

```text
Absolute Position = 60°
Relative Position = 60° - 27° = 33°
```

👉 **这 33° 正是用户关心的“从测试起点转了多少”**

------

## 三、为什么不能用绝对位置替代相对位置（关键论证）

### 1️⃣ 绝对位置不能频繁改

- 改绝对位置：
  - 会破坏限位判断
  - 会影响同步轴
  - 会引入安全风险

------

### 2️⃣ 测试与生产的关注点不同

| 角色               | 关注点   |
| ------------------ | -------- |
| PLC / 安全逻辑     | 绝对位置 |
| 调试 / 测试 / 用户 | 相对位置 |

👉 **强行让用户用绝对位置，是把测试成本转嫁给人**

------

### 3️⃣ 相对位置 ≠ 回原点

- 相对原点：
  - 只是“参考点”
  - 不涉及机械动作
- 回原点：
  - 是机械行为
  - 会修改绝对位置基准

👉 **两者在语义和风险上完全不同**

------

## 四、对 PLC 开发人员的明确要求（关键）

> PLC 程序必须同时维护：
>
> - 绝对位置（不可随意改）
> - 相对原点偏移（可随时设 / 清）
> - 相对位置（对外主要展示）

并且：

- 所有限位 / 安全 / 同步判断：
  - **只允许基于绝对位置**
- 所有用户操作 / 测试显示：
  - **默认使用相对位置**

------

## 五、总结一句“工程共识”

> **绝对位置是“机器知道自己在哪”，
> 相对位置是“人知道自己关心什么”。**